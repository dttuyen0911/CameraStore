@model CameraStore.Models.Product

@{
    ViewData["Title"] = "productDetail";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<section class="breadcrumb-option">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb__text">
                    <h4>Product detail</h4>
                    <div class="breadcrumb__links">
                        <a asp-controller="Home" asp-action="Index">Home</a>
                        <a asp-controller="Home" asp-action="Store">Shop</a>
                        <span>Product detail</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Shop Details Section Begin -->
<section class="shop-details">
    <div class="product__details__pic">
        <div class="container">
            <div class="row">
                <!-- Image Column -->
                <div class="col-lg-7 col-md-7">
                    <div class="tab-content">
                        <div class="tab-pane active" id="tabs-1" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img src="~/Image/@Model.proUrlImage" alt="" style="height:500px;width:700px">
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Product Description Column -->
                <div class="col-lg-5 col-md-5" style="background:#ffffff">
                    <div class="product__details__text">
                        <h3>@Model.proName.ToUpper()</h3>
                        @if (Model.proSale == Model.proPrice)
                        {
                            <h3 style="color:#ff0000">Price: $@Model.proSale</h3>
                        }
                        else
                        {
                            <h3 style="color:#ff0000">Price: @Model.proSale <span>$@Model.proPrice</span></h3>
                        }                        
                        <h4>Status: @Model.proStatus</h4>
                        <h4>Quantity: @Model.proQuantity</h4>
                        <h4>Sold: @Model.proQuantitySold</h4>
                        <p>
                            @Model.proDescription
                        </p>
                        <a href="#tabs-5">Read More</a>
                        <div class="product__details__cart__option">
                            <div style="margin-bottom: 10px;">
                                <input type="number" value="1" min="0" max="@Model.proQuantity">
                            </div>
                            <div class="quantity">
                                <form class="add-to-cart-form" method="post" action="@Url.Action("AddToCart", "Cart")">
                                    <input type="hidden" name="customerId" value="@User.Identity.Name" />
                                    <input type="hidden" name="productId" value="@Model.proID" />
                                    <input type="hidden" name="quantity" value="1" />
                                    <input type="hidden" name="status" value="@Model.proStatus" />
                                    <input type="hidden" name="price" value="@Model.proPrice" />
                                    <button type="submit" class="primary-btn">Add To Cart</button>
                                </form>
                                </div>
                            </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="notification" style="display: none; position: fixed;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	z-index: 1000;" class="alert alert-success" role="alert">
        The product has been successfully added to the cart!
    </div>
    <div id="notification1" style="display: none; position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000;" class="alert alert-danger" role="alert">
        This product is currently out of stock. Please choose another product!
    </div>

</section>
<section>
    <div class="product__details__content">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="product__details__tab">
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" data-toggle="tab" href="#tabs-5"
                                   role="tab">Description</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#tabs-6" role="tab">
                                    Customer
                                    Previews(5)
                                </a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="tabs-5" role="tabpanel">
                                <div class="product__details__tab__content">
                                    <div class="product__details__tab__content__item">
                                        <h5>Products Infomation</h5>
                                        <p>
                                            @Model.proDescription
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tabs-6" role="tabpanel">
                                <div class="product__details__tab__content">
                                    <div class="product__details__tab__content__item">
                                        <h5>Products Infomation</h5>
                                        <p>
                                            A Pocket PC is a handheld computer, which features many of the same
                                            capabilities as a modern PC. These handy little devices allow
                                            individuals to retrieve and store e-mail messages, create a contact
                                            file, coordinate appointments, surf the internet, exchange text messages
                                            and more. Every product that is labeled as a Pocket PC must be
                                            accompanied with specific software to operate the unit and must feature
                                            a touchscreen and touchpad.
                                        </p>
                                        <p>
                                            As is the case with any new technology product, the cost of a Pocket PC
                                            was substantial during it’s early release. For approximately $700.00,
                                            consumers could purchase one of top-of-the-line Pocket PCs in 2003.
                                            These days, customers are finding that prices have become much more
                                            reasonable now that the newness is wearing off. For approximately
                                            $350.00, a new Pocket PC can now be purchased.
                                        </p>
                                    </div>
                                    <div class="product__details__tab__content__item">
                                        <h5>Material used</h5>
                                        <p>
                                            Polyester is deemed lower quality due to its none natural quality’s. Made
                                            from synthetic materials, not natural like wool. Polyester suits become
                                            creased easily and are known for not being breathable. Polyester suits
                                            tend to have a shine to them compared to wool and cotton suits, this can
                                            make the suit look cheap. The texture of velvet is luxurious and
                                            breathable. Velvet is a great choice for dinner party jacket and can be
                                            worn all year round.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Shop Details Section End -->
<!-- Related Section Begin -->
<section class="related spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <h3 class="related-title">Related Product</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-3 col-md-6 col-sm-6 col-sm-6">
                <div class="product__item">
                    <div class="product__item__pic set-bg" data-setbg="../cameraStoreLayout/img/product/product-1.jpg">
                        <span class="label">New</span>
                        <ul class="product__hover">
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/heart.png" alt=""></a></li>
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/compare.png" alt=""> <span>Compare</span></a></li>
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/search.png" alt=""></a></li>
                        </ul>
                    </div>
                    <div class="product__item__text">
                        <h6>Piqué Biker Jacket</h6>
                        <a href="#" class="add-cart">+ Add To Cart</a>
                        <div class="rating">
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                        </div>
                        <h5>$67.24</h5>
                        <div class="product__color__select">
                            <label for="pc-1">
                                <input type="radio" id="pc-1">
                            </label>
                            <label class="active black" for="pc-2">
                                <input type="radio" id="pc-2">
                            </label>
                            <label class="grey" for="pc-3">
                                <input type="radio" id="pc-3">
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-sm-6">
                <div class="product__item">
                    <div class="product__item__pic set-bg" data-setbg="../cameraStoreLayout/img/product/product-2.jpg">
                        <ul class="product__hover">
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/heart.png" alt=""></a></li>
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/compare.png" alt=""> <span>Compare</span></a></li>
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/search.png" alt=""></a></li>
                        </ul>
                    </div>
                    <div class="product__item__text">
                        <h6>Piqué Biker Jacket</h6>
                        <a href="#" class="add-cart">+ Add To Cart</a>
                        <div class="rating">
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                        </div>
                        <h5>$67.24</h5>
                        <div class="product__color__select">
                            <label for="pc-4">
                                <input type="radio" id="pc-4">
                            </label>
                            <label class="active black" for="pc-5">
                                <input type="radio" id="pc-5">
                            </label>
                            <label class="grey" for="pc-6">
                                <input type="radio" id="pc-6">
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-sm-6">
                <div class="product__item sale">
                    <div class="product__item__pic set-bg" data-setbg="../cameraStoreLayout/img/product/product-3.jpg">
                        <span class="label">Sale</span>
                        <ul class="product__hover">
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/heart.png" alt=""></a></li>
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/compare.png" alt=""> <span>Compare</span></a></li>
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/search.png" alt=""></a></li>
                        </ul>
                    </div>
                    <div class="product__item__text">
                        <h6>Multi-pocket Chest Bag</h6>
                        <a href="#" class="add-cart">+ Add To Cart</a>
                        <div class="rating">
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star-o"></i>
                        </div>
                        <h5>$43.48</h5>
                        <div class="product__color__select">
                            <label for="pc-7">
                                <input type="radio" id="pc-7">
                            </label>
                            <label class="active black" for="pc-8">
                                <input type="radio" id="pc-8">
                            </label>
                            <label class="grey" for="pc-9">
                                <input type="radio" id="pc-9">
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-sm-6">
                <div class="product__item">
                    <div class="product__item__pic set-bg" data-setbg="../cameraStoreLayout/img/product/product-4.jpg">
                        <ul class="product__hover">
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/heart.png" alt=""></a></li>
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/compare.png" alt=""> <span>Compare</span></a></li>
                            <li><a href="#"><img src="../cameraStoreLayout/img/icon/search.png" alt=""></a></li>
                        </ul>
                    </div>
                    <div class="product__item__text">
                        <h6>Diagonal Textured Cap</h6>
                        <a href="#" class="add-cart">+ Add To Cart</a>
                        <div class="rating">
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                            <i class="fa fa-star-o"></i>
                        </div>
                        <h5>$60.9</h5>
                        <div class="product__color__select">
                            <label for="pc-10">
                                <input type="radio" id="pc-10">
                            </label>
                            <label class="active black" for="pc-11">
                                <input type="radio" id="pc-11">
                            </label>
                            <label class="grey" for="pc-12">
                                <input type="radio" id="pc-12">
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Related Section End -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $('form.add-to-cart-form').submit(function (event) {
            // Ngăn chặn hành động gửi mặc định của form
            event.preventDefault();
            var isAuthenticated = @(User.Identity.IsAuthenticated ? "true" : "false");
            if (!isAuthenticated) {
                // Nếu chưa đăng nhập, chuyển hướng sang trang login
                window.location.href = "/Authentication/Login";
            } else {
                // Lấy giá trị của trạng thái sản phẩm
                var productStatus = $('input[name="status"]').val();

                if (productStatus === "Sold out") {
                    // Hiển thị thông báo nếu sản phẩm đã hết hàng
                    $('#notification1').fadeIn().delay(1000).fadeOut();
                    return;
                }

                var formData = $(this).serialize();

                // Gửi yêu cầu AJAX
                $.ajax({
                    type: 'POST',
                    url: $(this).attr('action'),
                    data: formData,
                    success: function (response) {
                        // Hiển thị thông báo khi thêm vào giỏ hàng thành công
                        $('#notification').fadeIn().delay(1000).fadeOut(); // Hiển thị div và sau đó ẩn nó sau 2 giây
                    },
                    error: function (xhr, status, error) {
                        // Xử lý lỗi nếu có
                        console.error(error);
                    }
                });
            }
        });
    });
</script>
